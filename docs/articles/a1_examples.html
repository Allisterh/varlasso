<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Examples using the varlasso package • varlasso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Examples using the varlasso package">
<meta property="og:description" content="varlasso">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">varlasso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a1_examples.html">Examples using the varlasso package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nwfsc-timeseries/varlasso/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Examples using the varlasso package</h1>
            
            <h4 data-toc-skip class="date">2022-09-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/nwfsc-timeseries/varlasso/blob/HEAD/vignettes/a1_examples.Rmd" class="external-link"><code>vignettes/a1_examples.Rmd</code></a></small>
      <div class="hidden name"><code>a1_examples.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nwfsc-timeseries.github.io/varlasso/" class="external-link">varlasso</a></span><span class="op">)</span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>varlasso</code> R package is designed to fit vector autoregressive (VAR) models, with and without observation error in a Bayesian setting. The basic formulation of these types of models consists of a process model describing the latent time series in <span class="math inline">\(\mathbf{x_{t}}\)</span>,</p>
<p><span class="math display">\[\mathbf{x_{t}} = \mathbf{Bx_{t-1}} + \mathbf{u} + \mathbf{w_{t-1}}\]</span> where <span class="math inline">\(\mathbf{Bx_{t-1}}\)</span> is a matrix of coefficients describing interactions among time series, <span class="math inline">\(\mathbf{u}\)</span> is an optional trend, and <span class="math inline">\(\mathbf{w_{t-1}}\)</span> is a vector of deviations from a multivariate normal distribution, <span class="math inline">\(\mathbf{w_{t}} \sim MVN(\mathbf{0}, \mathbf{Q})\)</span>. The covariance matrix <span class="math inline">\(\mathbf{Q}\)</span> may be an identity matrix or include estimated covariance between time series.</p>
<p>In the context of ecological examples using the VAR approach (sometimes called multivariate autoregressive or MAR models), the <span class="math inline">\(\mathbf{x_{t}}\)</span> can be viewed as log-abundances of different species, and the <span class="math inline">\(\mathbf{B}\)</span> matrix a matrix of interactions. Diagonals of the <span class="math inline">\(\mathbf{B}\)</span> matrix represent density dependence, and off-diagonals represent interspecific interactions.</p>
<p>The other component of a VAR model is optionally observation errors. To avoid confusion, we refer to the model with observation error as a VARSS (Vector Autoregressive State Space) model. The observation model can be written as</p>
<p><span class="math display">\[\mathbf{y_{t}} \sim MVN(\mathbf{x_{t}}, \mathbf{R})\]</span> where <span class="math inline">\(\mathbf{R}\)</span> is a covariance matrix of the observation errors.</p>
</div>
<div class="section level2">
<h2 id="simulating-data-from-a-var-model">Simulating data from a VAR model<a class="anchor" aria-label="anchor" href="#simulating-data-from-a-var-model"></a>
</h2>
<p>We can fit a VAR model to simulated data</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">iter</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># MCMC iterations, make this much larger</span>
<span class="va">warmup</span> <span class="op">&lt;-</span> <span class="fl">20</span> <span class="co"># MCMC warmup, make this much larger</span>
<span class="va">thin</span> <span class="op">&lt;-</span> <span class="fl">1</span>
<span class="va">chains</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># MCMC chains, make this 3 or 4</span>

<span class="va">n_ts</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># number of time series to simulate</span>
<span class="va">n_time</span> <span class="op">&lt;-</span> <span class="fl">70</span> <span class="co"># number of time points to simulate for</span>
<span class="va">n_burn</span> <span class="op">&lt;-</span> <span class="fl">50</span> <span class="co"># burn-in for time series</span>
<span class="va">xx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n_time</span>, <span class="va">n_ts</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span> 
<span class="va">xx</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_ts</span><span class="op">)</span> <span class="co"># initial state</span>
<span class="va">B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">n_ts</span> <span class="op">*</span> <span class="va">n_ts</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>, <span class="va">n_ts</span>, <span class="va">n_ts</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">B</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_ts</span>, min <span class="op">=</span> <span class="fl">0.7</span>, max <span class="op">=</span> <span class="fl">0.9</span><span class="op">)</span> <span class="co"># make diagonals 0.7 - 0.9</span></code></pre></div>
<p>Here is what the <span class="math inline">\(\mathbf{B}\)</span> matrix looks like,</p>
<table class="table"><tbody>
<tr class="odd">
<td align="right">0.73</td>
<td align="right">-0.07</td>
<td align="right">0.04</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="right">0.17</td>
<td align="right">0.78</td>
<td align="right">0.01</td>
<td align="right">-0.20</td>
</tr>
<tr class="odd">
<td align="right">0.05</td>
<td align="right">0.12</td>
<td align="right">0.78</td>
<td align="right">0.07</td>
</tr>
<tr class="even">
<td align="right">-0.13</td>
<td align="right">0.04</td>
<td align="right">0.18</td>
<td align="right">0.77</td>
</tr>
</tbody></table>
<p>Next we can simulate the evolution of the states,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">n_time</span><span class="op">)</span> <span class="op">{</span> <span class="co"># simualte evolution of states</span>
  <span class="va">xx</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">B</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">xx</span><span class="op">[</span><span class="va">i</span> <span class="op">-</span> <span class="fl">1</span>, <span class="op">]</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_ts</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.04</span><span class="op">)</span>
<span class="op">}</span>
<span class="va">xx</span> <span class="op">&lt;-</span> <span class="va">xx</span><span class="op">[</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">n_burn</span><span class="op">)</span>, <span class="op">]</span> <span class="co"># drop burn in data</span></code></pre></div>
<p>Finally we can add observation error noise</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">yy</span> <span class="op">&lt;-</span> <span class="va">xx</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">xx</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">xx</span><span class="op">)</span>, mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.02</span><span class="op">)</span>
<span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>
  <span class="st">"time"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span><span class="op">)</span>,
  <span class="st">"species"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,
  <span class="st">"y"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yy</span><span class="op">)</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>
<span class="co">#&gt;   time species           y</span>
<span class="co">#&gt; 1    1       1 -0.08156230</span>
<span class="co">#&gt; 2    2       1  0.01676388</span>
<span class="co">#&gt; 3    3       1 -0.04290659</span>
<span class="co">#&gt; 4    4       1  0.04923091</span>
<span class="co">#&gt; 5    5       1  0.01031494</span>
<span class="co">#&gt; 6    6       1  0.02013256</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="fitting-a-model-and-optional-arguments">Fitting a model (and optional arguments)<a class="anchor" aria-label="anchor" href="#fitting-a-model-and-optional-arguments"></a>
</h2>
<p>We can fit a model to this data using the <code><a href="../reference/fit.html">varlasso::fit</a></code> function, which at a minimum takes in the dataframe and MCMC parameters.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>There are a few optional arguments that may be applied to this or any model. The <code>shared_q</code> and <code>shared_r</code> arguments can be used to pass in vectors indicating which process error or observation error variances may be shared across time series. By default, all variances are shared across time series. In the example below, process variances are shared among the 1st and 4th time series, and unique for time series 2 and 3. Similarly for the observation error variances, time series 1 and 4 have equal variances and time series 2 and 3 have equal variances.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         shared_q <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span>,
         shared_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>In some cases, it may be desireable to fix observation variances; this can be done using the <code>fixed_r</code> argument. The <code>fixed_r</code> argument can be a vector of fixed values, or alternatively a single scalar.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         fixed_r <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>For some cases, we may also want to ignore the trend <span class="math inline">\(\mathbf{u}\)</span>. This can be turned on / off using the <code>est_trend</code> argument</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         est_trend <span class="op">=</span> <span class="cn">FALSE</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>Finally, observation error can be turned on / off using the <code>varss</code> argument. When FALSE, a VAR model is constructed, and if TRUE a VARSS model is fit.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         varss <span class="op">=</span> <span class="cn">FALSE</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>There are a number of additional arguments documented in <code><a href="../reference/fit.html">?fit</a></code></p>
</div>
<div class="section level2">
<h2 id="default-priors">Default priors<a class="anchor" aria-label="anchor" href="#default-priors"></a>
</h2>
<p>Many VAR or VARSS models struggle as the number of time series increases, because of the dimensionality of the interaction matrix <span class="math inline">\(\mathbf{B}\)</span>. The <code>varlasso</code> in this package allows models with alternative priors on the diagonal and off-diagonal elements. By default, these priors are</p>
<p><span class="math display">\[\mathbf{B_{i,i}} \sim N(0.7, 1)\]</span> and <span class="math display">\[\mathbf{B_{i,j}} \sim N(0, 1)\]</span> These priors may be specified by changing the arguments <code>b_diag</code> and <code>b_offdiag</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         b_diag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">0.3</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
         b_offdiag <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="shrinkage-priors">Shrinkage priors<a class="anchor" aria-label="anchor" href="#shrinkage-priors"></a>
</h2>
<p>The <code>varlasso</code> package currently only allows for normal priors on the diagonal elements. But because the number of off-diagonal elements can become prohibitively large to work with, we allow for a number of shrinkage priors. These can be changed by using the <code>off_diag_prior</code> argument (defaults to ‘normal’).</p>
<p>As a first option, we may use a partial pooling prior (or hierarchical prior) that estimates a standard deviation, e.g.</p>
<p><span class="math display">\[\mathbf{B_{i,i}} \sim N(0.7, \sigma_{B})\]</span> This prior can be specified using the following</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         off_diag_prior <span class="op">=</span> <span class="st">"normal_pp"</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>Second, we might want to include more extremes in the tails than a normal prior, so instead a Student t-distribution can be included,</p>
<p><span class="math display">\[\mathbf{B_{i,i}} \sim Student-t(0.7, \sigma_{B}, \nu)\]</span> where <span class="math inline">\(\nu\)</span> is included as an estimated degrees of freedom parameter. This prior is specified by setting <code>off_diag_prior</code> to “student_t”. The <span class="math inline">\(\nu\)</span> parameter can also be optionally fixed with the <code>nu</code> argument, e.g.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         nu <span class="op">=</span> <span class="fl">5</span>,
         off_diag_prior <span class="op">=</span> <span class="st">"student-t"</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>As a third prior, we include the Laplace prior (this is also known as a double exponential distribution). This prior has an estimated scale parameter, and is specified with the chunk below</p>
<p><span class="math display">\[\mathbf{B_{i,i}} \sim Laplace(0, \sigma_{B})\]</span></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df</span>, 
         chains <span class="op">=</span> <span class="va">chains</span>, 
         nu <span class="op">=</span> <span class="fl">5</span>,
         off_diag_prior <span class="op">=</span> <span class="st">"laplace"</span>,
         iter <span class="op">=</span> <span class="va">iter</span>, 
         warmup <span class="op">=</span> <span class="va">warmup</span>, 
         thin <span class="op">=</span> <span class="va">thin</span><span class="op">)</span></code></pre></div>
<p>Finally, we can include a regularized horseshoe prior,</p>
<p><span class="math display">\[\mathbf{B_{i,i}} \sim hs(\theta)\]</span></p>
<p>We adopt the same parameterization in <code>rstanarm</code> and <code>brms</code>. This prior requires specifying several hyperparameters <span class="math inline">\(\theta\)</span>, stored as a list in <code>hs</code>. The elements of this list include</p>
<ul>
<li>
<code>df</code> Degrees of freedom for the Student-t prior for local shrinkage</li>
<li>
<code>df_global</code> Student-t degrees of freedom for global shrinkage</li>
<li>
<code>df_slab</code> Degrees of freedom of the Student-t prior on the slab regularization</li>
<li>
<code>scale_global</code> Scale parameter for Student-t prior on global shrinkage</li>
<li>
<code>scale_slab</code> Scale of the Student-t prior on shrinkage</li>
</ul>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">fit</span>(<span class="at">data =</span> df, </span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>         <span class="at">chains =</span> chains, </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>         <span class="at">off_diag_prior =</span> <span class="st">"hs"</span>,</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">hs =</span> <span class="fu">list</span>(<span class="at">df =</span> <span class="dv">1</span>, <span class="at">df_global =</span> <span class="dv">1</span>, <span class="at">df_slab =</span> <span class="dv">4</span>, <span class="at">scale_global =</span> <span class="dv">1</span>, <span class="at">scale_slab =</span> <span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">iter =</span> iter, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">warmup =</span> warmup, </span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">thin =</span> thin)</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Eric Ward.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
